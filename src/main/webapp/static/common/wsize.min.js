/*!
 * Copyright &copy; 2012-2016 <a href="https://github.com/thinkgem/jeesite">JeeSite</a> All rights reserved.
 * 
 * 主框架窗口大小调整
 * @author ThinkGem
 * @version 2013-11-09
 */

$("#left").width(leftWidth);
$("#menu-index").width(leftWidth);
$("#openClose").click(function(){
	if($(this).hasClass("close")){
		$(this).removeClass("close");
		$(this).addClass("open");
		$("#left").animate({width:43});
		$("#menu-index").animate({width:0});
		$("#menu-index").hide();
		//$("#left ul li span").hide();
		$("#left li .sub").hide();
		$(".subMenu li h3 a").removeClass("acur");
		$(".subMenu li a").removeClass("acur");
		$(".subMenu li h3 em.arrow").hide();
		console.log("---");
		console.log($("#main").width());
		console.log($("#openClose").width());
		console.log("---");
		$("#right").animate({width:$("#main").width()-$("#openClose").width()},function(){
			if(typeof openCloseClickCallBack == 'function'){
				openCloseClickCallBack(true);
			}
			wSize();
		});
	}else{
		$(this).addClass("close");
		$(this).removeClass("open");
		//$("#left ul li span").fadeIn();
		$(".subMenu li h3 em.arrow").show();
		$("#left").animate({width:leftWidth,opacity:"show"});
		$("#menu-index").animate({width:leftWidth,opacity:"show"});
		$("#right").animate({width:$("#main").width()-$("#openClose").width()-leftWidth},function(){
			if(typeof openCloseClickCallBack == 'function'){
				openCloseClickCallBack(true);
			}
			wSize();
		});
	}
});

//头部右边图标收缩左边菜单
$("#topMenuIco").click(function(){
	//首页暂时不收缩
	if($("#menu-index").attr("style").indexOf("display: none")==-1){
		return false;
	}
	if($(this).hasClass("Close")){
		$(this).removeClass("Close");
		$(this).addClass("Open");
		$("#left").animate({width:43});
		$("#left ul li span").hide();
		$("#left li .sub").hide();
		$(".subMenu li h3 a").removeClass("acur");
		$(".subMenu li a").removeClass("acur");
		$(".subMenu li h3 em.arrow").hide();
		$("#right").animate({width:$("#main").width()-$("#openClose").width()-43},function(){
			if(typeof openCloseClickCallBack == 'function'){
				openCloseClickCallBack(true);
			}
			wSize(43);
		});
	}else{
		$(this).addClass("Close");
		$(this).removeClass("Open");
		$("#left ul li span").fadeIn();
		//$(".subMenu li h3 a em.arrow").show();
		$(".subMenu li h3 a span").show();
		$("#left").animate({width:leftWidth,opacity:"show"});
		$("#right").animate({width:$("#main").width()-$("#openClose").width()-leftWidth},function(){
			if(typeof openCloseClickCallBack == 'function'){
				openCloseClickCallBack(true);
			}
			wSize(230);
		});
	}
});

//判断1280分辨率左侧菜单自动收缩
$(document).ready(function(){
        if (window.screen.width < 1290) {
		$("#topMenuIco").removeClass("Close")
		$("#topMenuIco").addClass("Open")
		$("#left").animate({width:43});
		$("#left ul li span").hide();
		$("#left li .sub").hide();
		$(".subMenu li h3 a").removeClass("acur");
		$(".subMenu li a").removeClass("acur");
		$(".subMenu li h3 em.arrow").hide();
		  $(".subMenu li").mouseover(function(){
			 if($("#topMenuIco").hasClass("Open")){
				$(this).find(".sub").addClass("hoverClass");
				$(this).find(".sub").show();
				$(".subMenu li h3 a").removeClass("acur");
				$(this).find("h3").find("a").addClass("acur");
			}
		 })	
		   $(".subMenu li").mouseout(function(){
			 if($("#topMenuIco").hasClass("Open")){
				$(this).find(".sub").hide();
				$(".subMenu li h3 a").removeClass("acur");
				$(".subMenu li .sub").removeClass("hoverClass");
			}
		 })
		console.log("---");
		console.log($("#content").width());
		console.log($("#openClose").width());
		console.log("---");
		$("#right").animate({width:$("#main").width()-$("#openClose").width()-leftWidth},function(){
			if(typeof openCloseClickCallBack == 'function'){
				openCloseClickCallBack(true);
			}
			wSize();
			
			});
        }

  });	


if(!Array.prototype.map)
	Array.prototype.map = function(fn,scope) {
	var result = [],ri = 0;
	for (var i = 0,n = this.length; i < n; i++){
	  if(i in this){
	    result[ri++]  = fn.call(scope ,this[i],i,this);
	  }
	}
	return result;
};
var getWindowSize = function(){
	return ["Height","Width"].map(function(name){
	  return window["inner"+name] ||
		document.compatMode === "CSS1Compat" && document.documentElement[ "client" + name ] || document.body[ "client" + name ];
	});
};
$(window).resize(function(){
	wSize();
});
wSize(); // 在主窗体中定义，设置调整目标